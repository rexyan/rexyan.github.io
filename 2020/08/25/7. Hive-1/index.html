<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rexyan.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"top","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"buttons","active":null,"storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Disqus","order":-1}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="介绍描述Hive 是一个数据仓库软件，可以使用 SQL 来促进对已经存在在分布式设备中的数据进行读，写和管理等操作。Hive 在使用时，需要对已经存储的数据进行结构的投影(映射)，Hive 提供了一个命令行和 JDBC 的方式，让用户可以连接到 Hive 。注意：Hive 只能分析结构化的数据，Hive 在 Hadoop 之上，使用hive的前提是先要安装 Hadoop 特点 Hive 并不是一个">
<meta name="keywords" content="Hadoop,Hive">
<meta property="og:type" content="article">
<meta property="og:title" content="7. Hive-1">
<meta property="og:url" content="https://rexyan.github.io/2020/08/25/7. Hive-1/index.html">
<meta property="og:site_name" content="星尘">
<meta property="og:description" content="介绍描述Hive 是一个数据仓库软件，可以使用 SQL 来促进对已经存在在分布式设备中的数据进行读，写和管理等操作。Hive 在使用时，需要对已经存储的数据进行结构的投影(映射)，Hive 提供了一个命令行和 JDBC 的方式，让用户可以连接到 Hive 。注意：Hive 只能分析结构化的数据，Hive 在 Hadoop 之上，使用hive的前提是先要安装 Hadoop 特点 Hive 并不是一个">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5kz5x6jOLQ4sksmcHO5hpIrkiNAGYFss9KIXfz2zisyGDphKfXdd3UuByehEI77D5XIlX.nMk0avdQdibh7oH4c!/mnull&bo=lwS2AZcEtgEDCSw!&rf=photolist&t=5/r/_yake_qzoneimgout.png">
<meta property="og:image" content="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5kz5x6jOLQ4sksmcHO5hpIrMd4RbkOUaEnSGe4A.gqqkoT2KLyQAm6SR7rKUy3PCnoK48I2WwqIhVidqJFo0JnA!/mnull&bo=cwSkAHMEpAADCSw!&rf=photolist&t=5/r/_yake_qzoneimgout.png">
<meta property="og:image" content="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5s6J6uFGQqPFYcQi.4ATqeYkbXFVTS5RisR6Z7qlWCZbSKebZ2UwvQ78HMgkhu.ImyL3aXHMkXWHfWQdL0yxxvw!/mnull&bo=EgTpAhIE6QIDCSw!&rf=photolist&t=5/r/_yake_qzoneimgout.png">
<meta property="og:updated_time" content="2025-10-31T03:20:39.389Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="7. Hive-1">
<meta name="twitter:description" content="介绍描述Hive 是一个数据仓库软件，可以使用 SQL 来促进对已经存在在分布式设备中的数据进行读，写和管理等操作。Hive 在使用时，需要对已经存储的数据进行结构的投影(映射)，Hive 提供了一个命令行和 JDBC 的方式，让用户可以连接到 Hive 。注意：Hive 只能分析结构化的数据，Hive 在 Hadoop 之上，使用hive的前提是先要安装 Hadoop 特点 Hive 并不是一个">
<meta name="twitter:image" content="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5kz5x6jOLQ4sksmcHO5hpIrkiNAGYFss9KIXfz2zisyGDphKfXdd3UuByehEI77D5XIlX.nMk0avdQdibh7oH4c!/mnull&bo=lwS2AZcEtgEDCSw!&rf=photolist&t=5/r/_yake_qzoneimgout.png">

<link rel="canonical" href="https://rexyan.github.io/2020/08/25/7. Hive-1/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>7. Hive-1 | 星尘</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  
  <link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/lxgwwenkaiscreen.css" />
  <!-- 自定义为霞鹜文楷字体 -->
  <style>
	  body,div.post-body,h1,h2,h3,h4 {
		font-family: "LXGW WenKai Screen", sans-serif;
		font-size: 104%;
	  }
  </style>
  
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">星尘</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-读书">

    <a href="/books/" rel="section"><i class="address-book fa-fw"></i>读书</a>

  </li>
        <li class="menu-item menu-item-瞎扯">

    <a href="/crap/" rel="section"><i class="crap fa-fw"></i>瞎扯</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



<script src="https://cdn.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script>

<meta name="referrer" content="never">




  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://rexyan.github.io/2020/08/25/7. Hive-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/rexyan/warehouse/master/20230809141242.jpg">
      <meta itemprop="name" content="Rex">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="星尘">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          7. Hive-1
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-08-25 17:44:57" itemprop="dateCreated datePublished" datetime="2020-08-25T17:44:57+00:00">2020-08-25</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-31 03:20:39" itemprop="dateModified" datetime="2025-10-31T03:20:39+00:00">2025-10-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Java-大数据进阶/" itemprop="url" rel="index"><span itemprop="name">Java 大数据进阶</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><h4 id="描述"><a href="#描述" class="headerlink" title="描述"></a>描述</h4><p>Hive 是一个数据仓库软件，可以使用 SQL 来促进对已经存在在分布式设备中的数据进行读，写和管理等操作。Hive 在使用时，需要对已经存储的数据进行结构的投影(映射)，Hive 提供了一个命令行和 JDBC 的方式，让用户可以连接到 Hive 。注意：Hive 只能分析结构化的数据，Hive 在 Hadoop 之上，使用hive的前提是先要安装 Hadoop</p>
<h4 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h4><ol>
<li><p>Hive 并不是一个关系型数据库</p>
</li>
<li><p>不是基于OLTP(在线事务处理。OLTP 设计的软件，侧重点在事务的处理，和在线访问。一般 RDMS 都是基于OLTP设计)设计的</p>
</li>
<li>Hive无法做到实时查询，不支持行级别更新(update,delete)</li>
<li>Hive 要分析的数据存储在 HDFS 中，Hive 为数据创建的表结构(schema)，存储在 RDMS 中</li>
<li>Hive 基于OLAP(在线分析处理。OLAP 设计的软件，侧重点在数据的分析上，不追求分析的效率)设计的</li>
<li>Hive 使用类 SQL，称为 HQL 对数据进行分析</li>
<li>Hive 容易使用，可扩展，有弹性 </li>
</ol>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>保证有 JAVA_HOME, HADOOP_HOME</p>
<p>将 bin 配置到 PATH 中，在环境变量中提供 HIVE_HOME</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">JAVA_HOME=/opt/module/jdk1.8.0_121</span><br><span class="line">HADOOP_HOME=/opt/module/hadoop-2.7.2</span><br><span class="line">HIVE_HOME=/opt/module/apache-hive-1.2.1-bin</span><br><span class="line"></span><br><span class="line">PATH=<span class="variable">$PATH</span>:<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$HIVE_HOME</span>/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME PATH HADOOP_HOME HIVE_HOME</span><br></pre></td></tr></table></figure>
<h3 id="简单操作"><a href="#简单操作" class="headerlink" title="简单操作"></a>简单操作</h3><h4 id="创建表和插入数据"><a href="#创建表和插入数据" class="headerlink" title="创建表和插入数据"></a>创建表和插入数据</h4><p>创建一张表</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> person(<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">20</span>), age <span class="built_in">int</span>);</span><br></pre></td></tr></table></figure>
<p>向表中插入数据。hive 执行 HQL 其实是将 HQL 翻译为 MR 程序在 Hadoop 上运行。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person <span class="keyword">values</span>(<span class="string">"张三"</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person <span class="keyword">values</span>(<span class="string">"李四"</span>, <span class="number">20</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> person <span class="keyword">values</span>(<span class="string">"王五"</span>, <span class="number">20</span>);</span><br></pre></td></tr></table></figure>
<p><img src="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5kz5x6jOLQ4sksmcHO5hpIrkiNAGYFss9KIXfz2zisyGDphKfXdd3UuByehEI77D5XIlX.nMk0avdQdibh7oH4c!/mnull&amp;bo=lwS2AZcEtgEDCSw!&amp;rf=photolist&amp;t=5/r/_yake_qzoneimgout.png" alt></p>
<p>查询插入的数据信息</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> person;</span><br></pre></td></tr></table></figure>
<p>在hdfs 的 <code>/user/hive/warehouse/person</code> 下，有很多文件，文件中存储的就是插入的数据信息，路径中的 person 代表表名。路径下的文件为存储的数据文件</p>
<p><img src="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5kz5x6jOLQ4sksmcHO5hpIrMd4RbkOUaEnSGe4A.gqqkoT2KLyQAm6SR7rKUy3PCnoK48I2WwqIhVidqJFo0JnA!/mnull&amp;bo=cwSkAHMEpAADCSw!&amp;rf=photolist&amp;t=5/r/_yake_qzoneimgout.png" alt></p>
<h4 id="自定义数据文件"><a href="#自定义数据文件" class="headerlink" title="自定义数据文件"></a>自定义数据文件</h4><p>创建表的时候如果没有指定数据的分割符，那么结构化的数据分割符默认是 <code>^</code> 。还可以在创建表的时候直接指定数据的分隔符，这里使用 <code>\t</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> student1(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="keyword">string</span>) <span class="keyword">ROW</span> <span class="keyword">FORMAT</span> <span class="keyword">DELIMITED</span> <span class="keyword">FIELDS</span> <span class="keyword">TERMINATED</span> <span class="keyword">BY</span> <span class="string">'\t'</span>;</span><br></pre></td></tr></table></figure>
<p>创建数据文件 test_file</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1       zhangsan</span><br><span class="line">2       lisi</span><br><span class="line">3       wangwu</span><br><span class="line">4       liqiang</span><br><span class="line">5       zhaoliu</span><br></pre></td></tr></table></figure>
<p>将数据文件上传到 hdfs 中 student 目录下 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop fs -put test_file /user/hive/warehouse/student</span><br></pre></td></tr></table></figure>
<p>执行查询就能看到查询结果</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">hive&gt; select * from student;</span><br><span class="line">OK</span><br><span class="line">1       zhangsan</span><br><span class="line">2       lisi</span><br><span class="line">3       wangwu</span><br><span class="line">4       liqiang</span><br><span class="line">5       zhaoliu</span><br><span class="line">Time taken: 1.33 seconds, Fetched: 5 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="元数据管理"><a href="#元数据管理" class="headerlink" title="元数据管理"></a>元数据管理</h3><p>hive 默认的元数据管理是使用 <a href="https://baike.baidu.com/item/Derby/7656169?fr=aladdin" target="_blank" rel="noopener">derby</a>，在 hive 中使用 derby 管理元数据的特点是只能允许一个 hive 的连接存在。在输入 hive 命令的目录下会生成一个 metastore_db 文件夹，该文件夹中存储的就是元数据。当切换目录执行 hive 命令时，又会在新目录下生成一个新的 metastore_db 文件夹，查看之前创建的表信息时会发现不存在（因为是新的 metastore_db 文件夹）</p>
<p>当已经有一个 hive 连接存在时，再次创建一个新的连接出现的错误信息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Caused by: ERROR XSDB6: Another instance of Derby may have already booted the database /opt/module/apache-hive-1.2.1-bin/metastore_db.</span><br></pre></td></tr></table></figure>
<h4 id="安装-MySQL"><a href="#安装-MySQL" class="headerlink" title="安装 MySQL"></a>安装 MySQL</h4><p>查看是否安装了 mysql，如果安装了需要将其卸载</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 apache-hive-1.2.1-bin]$ rpm -qa | grep mysql</span><br><span class="line">mysql-libs-5.1.73-7.el6.x86_64</span><br><span class="line">[rexyan@hadoop10 apache-hive-1.2.1-bin]$ sudo rpm -e --nodeps mysql-libs-5.1.73-7.el6.x86_64</span><br></pre></td></tr></table></figure>
<p>上传解压得到 mysql 安装包<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 soft]$ cd mysql-libs</span><br><span class="line">[rexyan@hadoop10 mysql-libs]$ ls -la</span><br><span class="line">总用量 76060</span><br><span class="line">drwxrwxr-x. 3 rexyan rexyan     4096 8月  24 23:17 .</span><br><span class="line">drwxr-xr-x. 3 rexyan rexyan     4096 8月  24 23:13 ..</span><br><span class="line">-rw-r--r--. 1 rexyan rexyan 18509960 8月  24 23:14 MySQL-client-5.6.24-1.el6.x86_64.rpm</span><br><span class="line">drwxrwxr-x. 4 rexyan rexyan     4096 8月  24 23:14 mysql-connector-java-5.1.27</span><br><span class="line">-rw-r--r--. 1 rexyan rexyan  3575135 8月  24 23:15 mysql-connector-java-5.1.27.tar.gz</span><br><span class="line">-rw-r--r--. 1 rexyan rexyan 55782196 8月  24 23:18 MySQL-server-5.6.24-1.el6.x86_64.rpm</span><br></pre></td></tr></table></figure></p>
<p>安装 mysql 服务器端</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-libs]$ sudo rpm -ivh MySQL-server-5.6.24-1.el6.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>查看默认密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-libs]$ sudo cat /root/.mysql_secret</span><br><span class="line"><span class="meta">#</span><span class="bash"> The random password <span class="built_in">set</span> <span class="keyword">for</span> the root user at Tue Aug 25 14:05:01 2020 (<span class="built_in">local</span> time): eHKx4R0nvli58uB3</span></span><br></pre></td></tr></table></figure>
<p>启动 mysql 服务端程序</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-libs]$ sudo service mysql start </span><br><span class="line">Starting MySQL.....[确定]</span><br><span class="line">[rexyan@hadoop10 mysql-libs]$ sudo service mysql status </span><br><span class="line">MySQL running (24737)[确定]</span><br><span class="line">[rexyan@hadoop10 mysql-libs]$</span><br></pre></td></tr></table></figure>
<p>安装 mysql 客户端程序</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-libs]$ sudo rpm -ivh MySQL-client-5.6.24-1.el6.x86_64.rpm</span><br></pre></td></tr></table></figure>
<p>连接登录修改密码</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-libs]$ mysql -uroot -peHKx4R0nvli58uB3</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> SET PASSWORD=PASSWORD(<span class="string">'123456'</span>);</span></span><br></pre></td></tr></table></figure>
<p>允许远程登录</p>
<p><img src="https://r.photo.store.qq.com/psc?/V12EvAd609VbnF/ruAMsa53pVQWN7FLK88i5s6J6uFGQqPFYcQi.4ATqeYkbXFVTS5RisR6Z7qlWCZbSKebZ2UwvQ78HMgkhu.ImyL3aXHMkXWHfWQdL0yxxvw!/mnull&amp;bo=EgTpAhIE6QIDCSw!&amp;rf=photolist&amp;t=5/r/_yake_qzoneimgout.png" alt></p>
<h4 id="管理元数据"><a href="#管理元数据" class="headerlink" title="管理元数据"></a>管理元数据</h4><p>拷贝 mysql 驱动 jar 包到 hive lib 目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 mysql-connector-java-5.1.27]$ cp mysql-connector-java-5.1.27-bin.jar /opt/module/apache-hive-1.2.1-bin/lib/</span><br></pre></td></tr></table></figure>
<p>在 hive conf 目录下创建 hive-site.xml 文件，内容如下</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0"?&gt;</span></span><br><span class="line"><span class="meta">&lt;?xml-stylesheet type="text/xsl" href="configuration.xsl"?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionURL<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">value</span>&gt;</span>jdbc:mysql://hadoop10:3306/metastore?createDatabaseIfNotExist=true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">description</span>&gt;</span>JDBC connect string for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionDriverName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">value</span>&gt;</span>com.mysql.jdbc.Driver<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">description</span>&gt;</span>Driver class name for a JDBC metastore<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionUserName<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">value</span>&gt;</span>root<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">description</span>&gt;</span>username to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">name</span>&gt;</span>javax.jdo.option.ConnectionPassword<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">value</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	  <span class="tag">&lt;<span class="name">description</span>&gt;</span>password to use against metastore database<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>手动创建库 metastore，注意编码要使用 latin1。再次进入 hive 交互终端，就可以看到在 mysql 的 metastore 库中创建了很多表，hive 中创建的表的信息都存储在 tbls 表中，通过 db_id 和 dbs 表中的库进行外键约束，hive 中库的信息都存储在 dbs 表中，hive 中的字段信息存在 column_v2 表中，通过 CD_ID 和表的主键进行外键约束。</p>
<h3 id="常见属性配置"><a href="#常见属性配置" class="headerlink" title="常见属性配置"></a>常见属性配置</h3><p>Default 数据仓库的最原始位置是在hdfs上的 /user/hive/warehouse 路径下，如果某张表属于 default 数据库，直接在数据仓库目录下创建一个文件夹。修改 default 数据仓库原始位置可以在 hive-site.xml 文件中添加如下信息。其中 value 就是存储数据的地方，该路径为 hdfs 的路径。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.metastore.warehouse.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/hive<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">description</span>&gt;</span>location of default database for the warehouse<span class="tag">&lt;/<span class="name">description</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>如果想在 hive 交互式命令行显示当前数据库，以及查询表的头信息，那么可以在 hive-site.xml 中添加以下配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.header<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hive.cli.print.current.db<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>true<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>hive 的日志默认存储在 /tmp/用户名/hive.log 中，如果要修改此目录，那么应该复制一份 hive-exec-log4j.properties.template 文件，将新文件名称修改为 hive-log4j.properties。并将其中的 hive.log.dir 值修改为存储日志的地址，重新进入交互式命令行即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hive.log.dir=/opt/module/apache-hive-1.2.1-bin/logs</span><br></pre></td></tr></table></figure>
<h3 id="交互式命令参数"><a href="#交互式命令参数" class="headerlink" title="交互式命令参数"></a>交互式命令参数</h3><p>在使用 hive 进入交互式操作的时候，可以在 hive 后面跟上一些参数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-d   定义一个变量，在hive启动后，可以使用$&#123;变量名&#125;引用变量</span><br><span class="line">--database   指定使用哪个库</span><br><span class="line">-e   后跟一条引号引起来的sql，执行完返回结果后退出cli</span><br><span class="line">-f   执行一个文件中的sql语句，执行完返回结果后退出cli</span><br><span class="line">--hiveconf   在cli运行之前，定义一对属性，hive在运行时，先读取 hadoop的全部8个配置文件，读取之后，再读取  hive-default.xml再读取hive-site.xml， 如果使用--hiveconf，可以定义一组属性，这个属性会覆盖之前读到的参数的值</span><br><span class="line">--hivevar   作用和-d是一致的，定义一个变量</span><br><span class="line">-i   和 -e 类似，区别在于执行完返回结果后不退出 cli</span><br><span class="line">-S   不打印和结果无关的信息</span><br></pre></td></tr></table></figure>
<p>hive 中执行 hdfs 和 linux 命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">!ls /tmp;  # 执行 linux 命令</span><br><span class="line">dfs -ls /user;   # 执行 hdfs 命令</span><br></pre></td></tr></table></figure>
<h3 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h3><p>基本数据类型</p>
<table>
<thead>
<tr>
<th>Hive数据类型</th>
<th>Java数据类型</th>
<th>长度</th>
</tr>
</thead>
<tbody>
<tr>
<td>TINYINT</td>
<td>byte</td>
<td>1byte有符号整数</td>
</tr>
<tr>
<td>SMALINT</td>
<td>short</td>
<td>2byte有符号整数</td>
</tr>
<tr>
<td>INT</td>
<td>int</td>
<td>4byte有符号整数</td>
</tr>
<tr>
<td>BIGINT</td>
<td>long</td>
<td>8byte有符号整数</td>
</tr>
<tr>
<td>BOOLEAN</td>
<td>boolean</td>
<td>布尔类型，true或者false</td>
</tr>
<tr>
<td>FLOAT</td>
<td>float</td>
<td>单精度浮点数</td>
</tr>
<tr>
<td>DOUBLE</td>
<td>double</td>
<td>双精度浮点数</td>
</tr>
<tr>
<td>STRING</td>
<td>string</td>
<td>字符系列。可以指定字符集。可以使用单引号或者双引号。</td>
</tr>
<tr>
<td>TIMESTAMP</td>
<td></td>
<td>时间类型</td>
</tr>
<tr>
<td>BINARY</td>
<td></td>
<td>字节数组</td>
</tr>
</tbody>
</table>
<p>集合数据类型</p>
<table>
<thead>
<tr>
<th>数据类型</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>struct</td>
<td>和c语言中的struct类似，都可以通过“点”符号访问元素内容。例如，如果某个列的数据类型是STRUCT{first STRING, last STRING},那么第1个元素可以通过字段.first来引用。</td>
</tr>
<tr>
<td>map</td>
<td>MAP是一组键-值对元组集合，使用数组表示法可以访问数据。例如，如果某个列的数据类型是MAP，其中键-&gt;值对是’first’-&gt;’John’和’last’-&gt;’Doe’，那么可以通过字段名[‘last’]获取最后一个元素</td>
</tr>
<tr>
<td>array</td>
<td>数组是一组具有相同类型和名称的变量的集合。这些变量称为数组的元素，每个数组元素都有一个编号，编号从零开始。例如，数组值为[‘John’,  ‘Doe’]，那么第2个元素可以通过数组名[1]进行引用。</td>
</tr>
</tbody>
</table>
<h4 id="创表示例"><a href="#创表示例" class="headerlink" title="创表示例"></a>创表示例</h4><p>例如有如下两条数据</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">songsong,bingbing_lili,xiao song:18_xiaoxiao song:19,hui long guan_beijing</span><br><span class="line">yangyang,caicai_susu,xiao yang:18_xiaoxiao yang:19,chao yang_beijing</span><br></pre></td></tr></table></figure>
<p>数据期待的 json 格式如下 ( Map和 Struct 的区别: Struct 中属性名是不变的, Map 中 key 可以变化的)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">"name"</span>: <span class="string">"songsong"</span>,</span><br><span class="line">    <span class="attr">"friends"</span>: [<span class="string">"bingbing"</span> , <span class="string">"lili"</span>] ,       <span class="comment">//列表Array, </span></span><br><span class="line">    <span class="attr">"children"</span>: &#123;                      <span class="comment">//键值Map,</span></span><br><span class="line">        <span class="attr">"xiao song"</span>: <span class="number">18</span> ,</span><br><span class="line">        <span class="attr">"xiaoxiao song"</span>: <span class="number">19</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">"address"</span>: &#123;                      <span class="comment">//结构Struct,</span></span><br><span class="line">        <span class="attr">"street"</span>: <span class="string">"hui long guan"</span> ,</span><br><span class="line">        <span class="attr">"city"</span>: <span class="string">"beijing"</span> </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>根据上面需求，建表语句如下</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> people(</span><br><span class="line"><span class="keyword">name</span> <span class="keyword">string</span>,   <span class="comment">-- name 字段，类型为 string</span></span><br><span class="line">friends <span class="built_in">array</span>&lt;<span class="keyword">string</span>&gt;,   <span class="comment">-- friends 字段，类型为 array，array 中存储 string 类型数据</span></span><br><span class="line">children <span class="keyword">map</span>&lt;<span class="keyword">string</span>,<span class="built_in">int</span>&gt;,  <span class="comment">-- children 字段，类型为 map，key 为 string，value 为 int 类型数据</span></span><br><span class="line">address <span class="keyword">struct</span>&lt;street:<span class="keyword">string</span>,city:<span class="keyword">string</span>&gt;)  <span class="comment">-- address 字段，类型为 struct。有两个属性 street city</span></span><br><span class="line"><span class="keyword">row</span> <span class="keyword">format</span> <span class="keyword">delimited</span> <span class="keyword">fields</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">','</span>  <span class="comment">-- 指定数据字段之间使用 “,” 进行分割</span></span><br><span class="line">collection items <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'_'</span>  <span class="comment">-- 字段中得数据使用 '_' 进行分割</span></span><br><span class="line"><span class="keyword">map</span> <span class="keyword">keys</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">':'</span>  <span class="comment">-- map 中的 key 和 value 使用 ':' 进行分割</span></span><br><span class="line"><span class="keyword">lines</span> <span class="keyword">terminated</span> <span class="keyword">by</span> <span class="string">'\n'</span>;  <span class="comment">-- 每行数据使用换行进行分割</span></span><br></pre></td></tr></table></figure>
<p>将数据上传至 hdfs 指定目录下</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[rexyan@hadoop10 test_file]$ hadoop fs -put create_table_test_data_file /hive/people</span><br></pre></td></tr></table></figure>
<p>在 hive 中查询，得到如下结果</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select * from people;</span><br><span class="line">OK</span><br><span class="line">people.name     people.friends  people.children people.address</span><br><span class="line">songsong        ["bingbing","lili"]     &#123;"xiao song":18,"xiaoxiao song":19&#125;     &#123;"street":"hui long guan","city":"beijing"&#125;</span><br><span class="line">yangyang        ["caicai","susu"]       &#123;"xiao yang":18,"xiaoxiao yang":19&#125;     &#123;"street":"chao yang","city":"beijing"&#125;</span><br><span class="line">Time taken: 0.749 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<p>可以看到 friends 列的值是 array 类型，children 是以 map 类型，address 是 struct 类型。</p>
<p>获取 friends 中的第一个值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select friends[0] from people;</span><br><span class="line">OK</span><br><span class="line">_c0</span><br><span class="line">bingbing</span><br><span class="line">caicai</span><br><span class="line">Time taken: 0.166 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<p>获取 children 中指定 key 的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select children["xiao song"] from people;</span><br><span class="line">OK</span><br><span class="line">_c0</span><br><span class="line">18</span><br><span class="line">NULL</span><br><span class="line">Time taken: 0.186 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<p>获取 address 中某个属性的值</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hive (default)&gt; select address.city from people;</span><br><span class="line">OK</span><br><span class="line">city</span><br><span class="line">beijing</span><br><span class="line">beijing</span><br><span class="line">Time taken: 0.163 seconds, Fetched: 2 row(s)</span><br></pre></td></tr></table></figure>
<h3 id="库操作"><a href="#库操作" class="headerlink" title="库操作"></a>库操作</h3><h4 id="增"><a href="#增" class="headerlink" title="增"></a>增</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE (DATABASE|SCHEMA) [IF NOT EXISTS] database_name  // 库名</span><br><span class="line">[COMMENT database_comment]  // 库的注释说明</span><br><span class="line">[LOCATION hdfs_path]        // 库在hdfs上的路径</span><br><span class="line">[WITH DBPROPERTIES (property_name=property_value, ...)]; // 库的属性</span><br></pre></td></tr></table></figure>
<p>例如创建一个库 mydb2，指定 hdfs 路径位置，并且设置库的属性值</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create database  if not exists mydb2 comment 'this is my db' location 'hdfs://hadoop101:9000/mydb2' with dbproperties('ownner'='jack','tel'='12345','department'='IT');</span><br></pre></td></tr></table></figure>
<h4 id="删"><a href="#删" class="headerlink" title="删"></a>删</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop database 库名 // 只能删除空库</span><br><span class="line">drop database 库名 cascade // 删除非空库</span><br></pre></td></tr></table></figure>
<h4 id="改"><a href="#改" class="headerlink" title="改"></a>改</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">use 库名  // 切换使用的库		</span><br><span class="line">dbproperties  // 修改库的属性值</span><br><span class="line">例如：alter database mydb2 set dbproperties(&apos;ownner&apos;=&apos;tom&apos;,&apos;empid&apos;=&apos;10001&apos;); 同名的属性值会覆盖，之前没有的属性会新增</span><br></pre></td></tr></table></figure>
<h4 id="查"><a href="#查" class="headerlink" title="查"></a>查</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show databases: 查看当前所有的库</span><br><span class="line">show tables in database: 查看库中所有的表</span><br><span class="line">desc database 库名： 查看库的描述信息</span><br><span class="line">desc database extended 库名： 查看库的详细描述信息</span><br></pre></td></tr></table></figure>
<h3 id="表操作"><a href="#表操作" class="headerlink" title="表操作"></a>表操作</h3><h4 id="增-1"><a href="#增-1" class="headerlink" title="增"></a>增</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE [EXTERNAL] TABLE [IF NOT EXISTS] table_name </span><br><span class="line">[(col_name data_type [COMMENT col_comment], ...)]   //表中的字段信息</span><br><span class="line">[COMMENT table_comment]  //表的注释</span><br><span class="line"></span><br><span class="line">[PARTITIONED BY (col_name data_type [COMMENT col_comment], ...)] </span><br><span class="line">[CLUSTERED BY (col_name, col_name, ...) </span><br><span class="line">[SORTED BY (col_name [ASC|DESC], ...)] INTO num_buckets BUCKETS] </span><br><span class="line"></span><br><span class="line">[ROW FORMAT row_format]   // 表中数据每行的格式，定义数据字段的分隔符，集合元素的分隔符等</span><br><span class="line">[STORED AS file_format]   //表中的数据要以哪种文件格式来存储，默认为TEXTFILE（文本文件）</span><br><span class="line">[LOCATION hdfs_path]  //表在hdfs上的位置</span><br></pre></td></tr></table></figure>
<p>建表时，如果不带 EXTERNAL ，那么创建的表是一个内部表或者叫做管理表。如果带有 EXTERNAL，那么创建的表是一个外部表。外部表和内部表的区别是内部表(管理表)在执行删除操作时，会将表的元数据(schema, 存在 MySQL 中的)和表位置的数据一起删除，外部表在执行删除表操作时，只删除表的元数据(schema， 存在 MySQL 中的)。在企业中，创建的都是外部表，因为在hive中表是廉价的，数据是珍贵的。</p>
<p>内部表和外部表的相互转换：<br>将表改为外部表 <code>alter table p1 set tblproperties(&#39;EXTERNAL&#39;=&#39;TRUE&#39;);</code><br>将表改为管理表 <code>alter table p1 set tblproperties(&#39;EXTERNAL&#39;=&#39;FALSE&#39;);</code></p>
<h4 id="删-1"><a href="#删-1" class="headerlink" title="删"></a>删</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">drop table 表名  // 删除表</span><br><span class="line">truncate table 表名 // 清空表数据，只能情况管理表</span><br></pre></td></tr></table></figure>
<h4 id="改-1"><a href="#改-1" class="headerlink" title="改"></a>改</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">alter table p1 set tblproperties(属性名=属性值);  // 修改表的属性</span><br><span class="line">alter table change 旧列名 新列名 新列类型;  // 修改列的名称和类型</span><br></pre></td></tr></table></figure>
<h4 id="查-1"><a href="#查-1" class="headerlink" title="查"></a>查</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">desc  表名  // 查看表的描述</span><br><span class="line">desc formatted 表名  // 查看表的详细描述</span><br></pre></td></tr></table></figure>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Hadoop/" rel="tag"><i class="fa fa-tag"></i> Hadoop</a>
              <a href="/tags/Hive/" rel="tag"><i class="fa fa-tag"></i> Hive</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/08/25/6. Hadoop HA/" rel="prev" title="6. Hadoop HA">
      <i class="fa fa-chevron-left"></i> 6. Hadoop HA
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/08/27/8. Hive-2/" rel="next" title="8. Hive-2">
      8. Hive-2 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#介绍"><span class="nav-number">1.</span> <span class="nav-text">介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#描述"><span class="nav-number">1.1.</span> <span class="nav-text">描述</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#特点"><span class="nav-number">1.2.</span> <span class="nav-text">特点</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装"><span class="nav-number">2.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单操作"><span class="nav-number">3.</span> <span class="nav-text">简单操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建表和插入数据"><span class="nav-number">3.1.</span> <span class="nav-text">创建表和插入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#自定义数据文件"><span class="nav-number">3.2.</span> <span class="nav-text">自定义数据文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#元数据管理"><span class="nav-number">4.</span> <span class="nav-text">元数据管理</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#安装-MySQL"><span class="nav-number">4.1.</span> <span class="nav-text">安装 MySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#管理元数据"><span class="nav-number">4.2.</span> <span class="nav-text">管理元数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#常见属性配置"><span class="nav-number">5.</span> <span class="nav-text">常见属性配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#交互式命令参数"><span class="nav-number">6.</span> <span class="nav-text">交互式命令参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据类型"><span class="nav-number">7.</span> <span class="nav-text">数据类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创表示例"><span class="nav-number">7.1.</span> <span class="nav-text">创表示例</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#库操作"><span class="nav-number">8.</span> <span class="nav-text">库操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#增"><span class="nav-number">8.1.</span> <span class="nav-text">增</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删"><span class="nav-number">8.2.</span> <span class="nav-text">删</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#改"><span class="nav-number">8.3.</span> <span class="nav-text">改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查"><span class="nav-number">8.4.</span> <span class="nav-text">查</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#表操作"><span class="nav-number">9.</span> <span class="nav-text">表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#增-1"><span class="nav-number">9.1.</span> <span class="nav-text">增</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删-1"><span class="nav-number">9.2.</span> <span class="nav-text">删</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#改-1"><span class="nav-number">9.3.</span> <span class="nav-text">改</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查-1"><span class="nav-number">9.4.</span> <span class="nav-text">查</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Rex"
      src="https://raw.githubusercontent.com/rexyan/warehouse/master/20230809141242.jpg">
  <p class="site-author-name" itemprop="name">Rex</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">446</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">183</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa-hand-o-right"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rex</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
