<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.9.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon.ico">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon.ico">
  <link rel="mask-icon" href="/favicon.ico" color="#222">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"rexyan.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"top","display":"hide","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":"mac"},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":true,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"buttons","active":null,"storage":true,"lazyload":true,"nav":{"disqus":{"text":"Load Disqus","order":-1}}},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":3,"unescape":false,"preload":false},"motion":{"enable":false,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="单表增删改查mybatis 核心文件 1234567891011121314151617181920212223242526272829303132333435363738&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&amp;gt; &amp;lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//E">
<meta name="keywords" content="Java 大数据,Mybatis">
<meta property="og:type" content="article">
<meta property="og:title" content="42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载">
<meta property="og:url" content="https://rexyan.github.io/2020/03/08/42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载/index.html">
<meta property="og:site_name" content="星尘">
<meta property="og:description" content="单表增删改查mybatis 核心文件 1234567891011121314151617181920212223242526272829303132333435363738&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&amp;gt; &amp;lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//E">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2025-10-31T03:20:39.386Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载">
<meta name="twitter:description" content="单表增删改查mybatis 核心文件 1234567891011121314151617181920212223242526272829303132333435363738&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&amp;gt; &amp;lt;!DOCTYPE configuration PUBLIC &quot;-//mybatis.org//DTD Config 3.0//E">

<link rel="canonical" href="https://rexyan.github.io/2020/03/08/42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载 | 星尘</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

  
  <link rel="stylesheet" href="https://cdn.staticfile.org/lxgw-wenkai-screen-webfont/1.6.0/lxgwwenkaiscreen.css" />
  <!-- 自定义为霞鹜文楷字体 -->
  <style>
	  body,div.post-body,h1,h2,h3,h4 {
		font-family: "LXGW WenKai Screen", sans-serif;
		font-size: 104%;
	  }
  </style>
  
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">星尘</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="archive fa-fw"></i>归档</a>

  </li>
        <li class="menu-item menu-item-读书">

    <a href="/books/" rel="section"><i class="address-book fa-fw"></i>读书</a>

  </li>
        <li class="menu-item menu-item-瞎扯">

    <a href="/crap/" rel="section"><i class="crap fa-fw"></i>瞎扯</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="user fa-fw"></i>关于</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



<script src="https://cdn.jsdelivr.net/npm/echarts@4.8.0/dist/echarts.min.js"></script>

<meta name="referrer" content="never">




  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="reading-progress-bar"></div>
  <a role="button" class="book-mark-link book-mark-link-fixed"></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://rexyan.github.io/2020/03/08/42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="https://raw.githubusercontent.com/rexyan/warehouse/master/20230809141242.jpg">
      <meta itemprop="name" content="Rex">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="星尘">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          42. Mybatis2 - 单表操作, 映射文件获取参数, 多对一查询, 一对多查询, 分布查询, 延迟加载
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2020-03-08 23:03:57" itemprop="dateCreated datePublished" datetime="2020-03-08T23:03:57+00:00">2020-03-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2025-10-31 03:20:39" itemprop="dateModified" datetime="2025-10-31T03:20:39+00:00">2025-10-31</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index"><span itemprop="name">技术</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="单表增删改查"><a href="#单表增删改查" class="headerlink" title="单表增删改查"></a>单表增删改查</h3><p>mybatis 核心文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> </span><br><span class="line"><span class="meta">&lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" </span></span><br><span class="line"><span class="meta"> "http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 加载外部文件到 properties --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"jdbc.properties"</span>&gt;</span><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line">		</span><br><span class="line">	<span class="comment">&lt;!-- 下划线转驼峰 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 表示 com.atguigu.bean 下所有的类都会被创建别名, Mapper xml 里面就可以简写了</span></span><br><span class="line"><span class="comment"> 				 只需要写类名或者类名首字母小写，不需要写完整的全限定名。</span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.atguigu.bean"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 使用 JDBC 原生的事务管理方式，即提交和回滚都需要手动处理 --&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span> /&gt;</span> </span><br><span class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></span><br><span class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></span><br><span class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 引入映射文件 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"EmpMapper.xml"</span> /&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"DeptMapper.xml"</span> /&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Emp 实体类对象</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.bean;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Emp</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">private</span> Integer eid;</span><br><span class="line">	<span class="keyword">private</span> String ename;</span><br><span class="line">	<span class="keyword">private</span> Integer age;</span><br><span class="line">	<span class="keyword">private</span> String sex;</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getEid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> eid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEid</span><span class="params">(Integer eid)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.eid = eid;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getEname</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ename;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setEname</span><span class="params">(String ename)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.ename = ename;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getSex</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> sex;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setSex</span><span class="params">(String sex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">this</span>.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">"Emp [eid="</span> + eid + <span class="string">", ename="</span> + ename + <span class="string">", age="</span> + age + <span class="string">", sex="</span> + sex + <span class="string">"]"</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Emp</span><span class="params">(Integer eid, String ename, Integer age, String sex)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">		<span class="keyword">this</span>.eid = eid;</span><br><span class="line">		<span class="keyword">this</span>.ename = ename;</span><br><span class="line">		<span class="keyword">this</span>.age = age;</span><br><span class="line">		<span class="keyword">this</span>.sex = sex;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="title">Emp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">		<span class="keyword">super</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>EmpMapper 映射类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 eid 查询员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpByEid</span><span class="params">(String eid)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 获取所有的员工信息</span></span><br><span class="line">	<span class="function">List&lt;Emp&gt; <span class="title">getAllEmp</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 添加员工信息</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 修改员工信息</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">updateEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 删除员工信息</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">deleteEmp</span><span class="params">(String eid)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>EmpMapper 映射xml 文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.EmpMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- Emp getEmpByEid(String eid); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByEid"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- List&lt;Emp&gt; getAllEmp(); </span></span><br><span class="line"><span class="comment">       注意虽然 getAllEmp 返回的是一个 list 集合，但是 resultType 还是写实体类</span></span><br><span class="line"><span class="comment">  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllEmp"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- void addEmp(Emp emp); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addEmp"</span>&gt;</span></span><br><span class="line">		insert into emp values(null, #&#123;ename&#125;, #&#123;age&#125;, #&#123;sex&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- void updateEmp(Emp emp); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateEmp"</span>&gt;</span></span><br><span class="line">		update emp set ename = #&#123;ename&#125;, age = #&#123;age&#125;, sex =#&#123;sex&#125; where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- void deleteEmp(String eid); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteEmp"</span>&gt;</span></span><br><span class="line">		delete from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>测试</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.EmpMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestCRUD</span> </span>&#123;</span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testCURD</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-conf.xml"</span>);</span><br><span class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		<span class="comment">// SqlSession sqlSession = sqlSessionFactory.openSession();   需要手动处理事务</span></span><br><span class="line">		SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>); <span class="comment">// 自动处理事务（默认为 false 不自动提交）</span></span><br><span class="line">		EmpMapper empMapper = sqlSession.getMapper(EmpMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 测试 getEmpByEid</span></span><br><span class="line">		Emp emp1 = empMapper.getEmpByEid(<span class="string">"1"</span>);</span><br><span class="line">		System.out.println(emp1);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 测试  getAllEmp</span></span><br><span class="line">		List&lt;Emp&gt; allEmp = empMapper.getAllEmp();</span><br><span class="line">		System.out.println(allEmp);</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 测试 addEmp</span></span><br><span class="line">		empMapper.addEmp(<span class="keyword">new</span> Emp(<span class="keyword">null</span>, <span class="string">"223333"</span>,<span class="number">23</span>, <span class="string">"nv"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 测试 updateEmp</span></span><br><span class="line">		empMapper.updateEmp(<span class="keyword">new</span> Emp(<span class="number">2</span>, <span class="string">"zhangsansan"</span>, <span class="number">33</span>, <span class="string">"nv"</span>));</span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 测试 deleteEmp</span></span><br><span class="line">		empMapper.deleteEmp(<span class="string">"6"</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="返回值为-Integer-或-bool"><a href="#返回值为-Integer-或-bool" class="headerlink" title="返回值为 Integer 或 bool"></a>返回值为 Integer 或 bool</h3><p>如果返回值是 Integer 或者 bool，我们只需将 mapper 接口中的返回值改成 Integer 或 </p>
<p>bool 即可。mapper.xml 中的 resultType 不用添加。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- void deleteEmp(String eid); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteEmp"</span>&gt;</span></span><br><span class="line">	delete from emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 删除员工信息(返回 Integer)</span></span><br><span class="line"><span class="function">Integer <span class="title">deleteEmp</span><span class="params">(String eid)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除员工信息(返回 Integer)</span></span><br><span class="line"><span class="comment">// Boolean deleteEmp(String eid);</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 测试 deleteEmp</span></span><br><span class="line"><span class="comment">// Integer i = empMapper.deleteEmp("6");</span></span><br><span class="line"><span class="comment">// System.out.println(i);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 测试 deleteEmp</span></span><br><span class="line">Boolean boolean1 = empMapper.deleteEmp(<span class="string">"6"</span>);</span><br><span class="line">System.out.println(boolean1);</span><br></pre></td></tr></table></figure>
<h3 id="package-的方式引入映射文件"><a href="#package-的方式引入映射文件" class="headerlink" title="package 的方式引入映射文件"></a>package 的方式引入映射文件</h3><p>之前在 mybatis 核心配置文件中引入 mapper.xml 映射文件的时候是一个一个单独引入的，这样很不方便。所以可以使用 package 来引入一个包下面的所有 mapper.xml 映射文件。但是这种写法必须将 mapper接口和 mapper.xml 映射文件放到同一个包下。由于 src 下面 com.atguigu.mapper 下面是存放 mapper 接口类的，所以我们应该将 mapper.xml 文件也放到下面才对，但是 xml 是文件不是类，放到里面不太合适，所以我们直接在 conf 下面也新建 com.atguigu.mapper 包，直接存放里面就行。（因为 src 和 cong 都是资源文件夹 source folder，所以在 ide 里面是分开的，但是最终 src 下的 com.atguigu.mapper  和 conf 下的 com.atguigu.mapper 里面的文件都是在一起的。）</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 引入映射文件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mappers</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &lt;mapper resource="EmpMapper.xml" /&gt;</span></span><br><span class="line"><span class="comment">	&lt;mapper resource="DeptMapper.xml" /&gt; --&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 使用 package 指定路径下的所有映射文件，而不是一个一个的引入。</span></span><br><span class="line"><span class="comment">	     但是这种写法必须将 mapper接口 和 mapper xml 映射文件放到同一个包下 </span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.atguigu.mapper"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="查询的三种方式"><a href="#查询的三种方式" class="headerlink" title="查询的三种方式"></a>查询的三种方式</h3><p>新增 EmpSelectMapper 接口类和 EmpSelectMapper.xml 映射文件演示。</p>
<h4 id="简单查询返回实体对象"><a href="#简单查询返回实体对象" class="headerlink" title="简单查询返回实体对象"></a>简单查询返回实体对象</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 根据 eid 查询员工信息</span></span><br><span class="line"><span class="function">Emp <span class="title">getEmpByEid</span><span class="params">(String eid)</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Emp getEmpByEid(String eid); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByEid"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">	select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="查询总记录数量"><a href="#查询总记录数量" class="headerlink" title="查询总记录数量"></a>查询总记录数量</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取所有的员工数量</span></span><br><span class="line"><span class="function">Integer <span class="title">getCount</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!--Integer getCount();--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCount"</span> <span class="attr">resultType</span>=<span class="string">"Integer"</span>&gt;</span></span><br><span class="line">	select count(eid) from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="将结果存放在-map-中"><a href="#将结果存放在-map-中" class="headerlink" title="将结果存放在 map 中"></a>将结果存放在 map 中</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 以 map 集合获取一个员工信息</span></span><br><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getEmpMapByEid</span><span class="params">(String eid)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 以 map 集合获取所有员工信息</span></span><br><span class="line"><span class="meta">@MapKey</span>(value = <span class="string">"eid"</span>) <span class="comment">// 设置每个 map 的键为 eid</span></span><br><span class="line"><span class="function">Map&lt;String, Object&gt; <span class="title">getAllEmpMap</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">&lt;!-- Map&lt;String, Object&gt; getEmpMapByEid(String eid); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpMapByEid"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">	select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Map&lt;String, Object&gt; getAllEmpMap(); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllEmpMap"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">	select eid, ename, age, sex from emp</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>完整代码如下：</p>
<p> EmpSelectMapper 接口类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.MapKey;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpSelectMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 eid 查询员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpByEid</span><span class="params">(String eid)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 获取所有的员工数量</span></span><br><span class="line">	<span class="function">Integer <span class="title">getCount</span><span class="params">()</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 以 map 集合获取一个员工信息</span></span><br><span class="line">	<span class="function">Map&lt;String, Object&gt; <span class="title">getEmpMapByEid</span><span class="params">(String eid)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 以 map 集合获取所有员工信息</span></span><br><span class="line">	<span class="meta">@MapKey</span>(value = <span class="string">"eid"</span>) <span class="comment">// 设置每个 map 的键为 eid</span></span><br><span class="line">	<span class="function">Map&lt;String, Object&gt; <span class="title">getAllEmpMap</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>EmpSelectMapper.xml 配置文件</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.EmpSelectMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- Emp getEmpByEid(String eid); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByEid"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!--Integer getCount();--&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getCount"</span> <span class="attr">resultType</span>=<span class="string">"Integer"</span>&gt;</span></span><br><span class="line">		select count(eid) from emp</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Map&lt;String, Object&gt; getEmpMapByEid(String eid); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpMapByEid"</span> <span class="attr">resultType</span>=<span class="string">"HashMap"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Map&lt;String, Object&gt; getAllEmpMap(); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllEmpMap"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="parameterType"><a href="#parameterType" class="headerlink" title="parameterType"></a>parameterType</h3><p>在 mapper.xml 文件中，insert, update 标签和 delete 标签是没有 resultType 属性的。但是可以设置 parameterType，用来指定传入参数的类型，但是在开发中一般不推荐写此属性，因为 mybatis 可以自动推断参数的类型。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- void updateEmp(Emp emp); parameterType 一般不写--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateEmp"</span> <span class="attr">parameterType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">	update emp set ename = #&#123;ename&#125;, age = #&#123;age&#125;, sex =#&#123;sex&#125; where eid = #&#123;eid&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="获取参数值的两种方式"><a href="#获取参数值的两种方式" class="headerlink" title="获取参数值的两种方式"></a>获取参数值的两种方式</h3><h4 id><a href="#" class="headerlink" title="${}"></a><strong>${}</strong></h4><p>相当于 Statement 对象，采用的字符串拼接的方式。所以这种方式是没有引号的，需要我们在 mapper.xml 的 SQL 手动的加上引号这样 SQL 才能没问题。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertEmp"</span>&gt;</span></span><br><span class="line">		insert into emp values(null, '$&#123;ename&#125;', $&#123;age&#125;, '$&#123;sex&#125;')</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="-1"><a href="#-1" class="headerlink" title="#{}"></a><strong>#{}</strong></h4><p>相当于 PreparedStatement，采用的是占位符的方式来拼接 SQL。这种方式是自带有引号的，我们不必手动添加引号。但是这种方式因为会自动加引号，所以在批量删除和批量修改还有模糊查询的时候不能用这种方式。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertEmp"</span>&gt;</span></span><br><span class="line">		insert into emp values(null, #&#123;ename&#125;, #&#123;age&#125;, #&#123;sex&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>大部分情况下我们都选择使用 <code>#{}</code> , 只有在特殊情况下才使用 <code>${}</code>，例如模糊查询和批量删除。</p>
<h3 id="获取新增自增-ID"><a href="#获取新增自增-ID" class="headerlink" title="获取新增自增 ID"></a>获取新增自增 ID</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">	useGeneratedKeys 默认就是 true（但建议使用的时候还是写出来），代表可以使用自动生成的主键</span></span><br><span class="line"><span class="comment"> 	keyProperty 代表将新增的主键值赋值给 实体类中的哪一个字段</span></span><br><span class="line"><span class="comment"> --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertEmp"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"eid"</span>&gt;</span></span><br><span class="line">	insert into emp values(null, #&#123;ename&#125;, #&#123;age&#125;, #&#123;sex&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">	InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-conf.xml"</span>);</span><br><span class="line">	SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">	SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>); </span><br><span class="line">	</span><br><span class="line">	ParamMapper paramMapper = sqlSession.getMapper(ParamMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">	Emp emp = <span class="keyword">new</span> Emp(<span class="keyword">null</span>, <span class="string">"1111"</span>, <span class="number">20</span>, <span class="string">"nana"</span>);</span><br><span class="line">	paramMapper.insertEmp(emp);</span><br><span class="line">	System.out.println(<span class="string">"新插入数据的 eid"</span> + emp.getEid());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="不同的参数类型取值的方式"><a href="#不同的参数类型取值的方式" class="headerlink" title="不同的参数类型取值的方式"></a>不同的参数类型取值的方式</h3><ol>
<li><p>当传输的参数为<strong>单个 String 或基本数据类型和其包装类</strong>时</p>
<p><code>#{}</code>: 可以以任意的名字获取参数值。</p>
<p><code>${}</code>: 只能以 <code>${value}</code> 或<code>${_parameter}</code> 方式获取。要注意单引号问题。</p>
</li>
<li><p>当传输参数为 <strong>JavaBean</strong> 时</p>
<p><code>#{}</code>和<code>${}</code>  都可以通过属性名直接获取属性值，但是要注意 <code>${}</code> 的单引号问题。</p>
</li>
<li><p>当传输<strong>多个参数</strong>时</p>
<p><code>#{}</code>: 可以使用 <code>#{0}</code> <code>#{1}</code> 或者  <code>#{param1}</code> <code>#{param2}</code> 去取值。</p>
<p><code>${}</code>: 只能使用  <code>#{param1}</code> <code>#{param2}</code> 去取值。要注意单引号问题。</p>
<p>即当传输任意多个参数时，都会被MyBatis重新包装成一个Map传入。Map的key是param1，param2，或者0，1…，值就是参数的值。</p>
</li>
<li><p>当传输的参数是 <strong>Map</strong> 时</p>
<p><code>#{}</code>和<code>${}</code>  都可以通过键的名字直接获取属性值，但是要注意 <code>${}</code> 的单引号问题。</p>
</li>
<li><p>命名参数</p>
<p>为参数使用 @Param 起一个名字，MyBatis 就会将这些参数封装进 map 中，key 就是我们自己指定的名字。<code>#{}</code>和<code>${}</code>  都可以通过键的名字直接获取属性值，但是要注意 <code>${}</code> 的单引号问题。</p>
</li>
<li><p>当传输参数为 List/Array 时</p>
<p>MyBatis 会将 List 或 Array 放在 map 中，List 以 list 为键，Array 以 array 为键。</p>
</li>
</ol>
<p>新建 ParamMapper 接口类和 ParamMapper.xml 映射文件进行演示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.annotations.Param;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ParamMapper</span> </span>&#123;</span><br><span class="line">	<span class="comment">// 添加员工信息</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">insertEmp</span><span class="params">(Emp emp)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 eid 获取员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpById</span><span class="params">(String eid)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 eid ename 查询员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpByEidAndEname</span><span class="params">(String eid, String ename)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 Map 查询员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpByMap</span><span class="params">(HashMap&lt;String, Object&gt; hashMap)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 根据 eid ename 查询员工信息</span></span><br><span class="line">	<span class="function">Emp <span class="title">getEmpByEidAndEnameByParam</span><span class="params">(@Param(<span class="string">"eid"</span>)</span> String eid, @<span class="title">Param</span><span class="params">(<span class="string">"ename"</span>)</span> String ename)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.ParamMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- void insertEmp(Emp emp); --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		useGeneratedKeys 默认就是 true，代表可以支持自动生成主键的字段</span></span><br><span class="line"><span class="comment">	 	keyProperty 代表将新增的主键值赋值给 实体类中的哪一个字段</span></span><br><span class="line"><span class="comment">	 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"insertEmp"</span> <span class="attr">useGeneratedKeys</span>=<span class="string">"true"</span> <span class="attr">keyProperty</span>=<span class="string">"eid"</span>&gt;</span></span><br><span class="line">		insert into emp values(null, #&#123;ename&#125;, #&#123;age&#125;, #&#123;sex&#125;)</span><br><span class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Emp getEmpById(String eid); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpById"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- getEmpByEidAndEname --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByEidAndEname"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;param1&#125; and ename = #&#123;param2&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- Emp getEmpByMap(Map&lt;String, Object&gt; map); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByMap"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125; and ename = #&#123;ename&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- getEmpByEidAndEnameByParam --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpByEidAndEnameByParam"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex from emp where eid = #&#123;eid&#125; and ename = #&#123;ename&#125; </span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>测试<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.EmpSelectMapper;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.ParamMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestParam</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-conf.xml"</span>);</span><br><span class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>); </span><br><span class="line">		</span><br><span class="line">		ParamMapper paramMapper = sqlSession.getMapper(ParamMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line"><span class="comment">//		Emp emp = new Emp(null, "1111", 20, "nana");</span></span><br><span class="line"><span class="comment">//		paramMapper.insertEmp(emp);</span></span><br><span class="line"><span class="comment">//		System.out.println("新插入数据的 eid" + emp.getEid());</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">//		Emp emp = paramMapper.getEmpById("1");</span></span><br><span class="line"><span class="comment">//		System.out.println(emp);</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">//		Emp empByEidAndEname = paramMapper.getEmpByEidAndEname("2", "zhangsansan");</span></span><br><span class="line"><span class="comment">//		System.out.println(empByEidAndEname);</span></span><br><span class="line">		</span><br><span class="line"><span class="comment">//		HashMap&lt;String,Object&gt; hashMap = new HashMap&lt;&gt;();</span></span><br><span class="line"><span class="comment">//		hashMap.put("eid", 2);</span></span><br><span class="line"><span class="comment">//		hashMap.put("ename", "zhangsansan");</span></span><br><span class="line"><span class="comment">//		Emp empByMap = paramMapper.getEmpByMap(hashMap);</span></span><br><span class="line"><span class="comment">//		System.out.println(empByMap);</span></span><br><span class="line">		</span><br><span class="line">		Emp empByEidAndEname = paramMapper.getEmpByEidAndEname(<span class="string">"2"</span>, <span class="string">"zhangsansan"</span>);</span><br><span class="line">		System.out.println(empByEidAndEname);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="自定义映射（多对一查询）"><a href="#自定义映射（多对一查询）" class="headerlink" title="自定义映射（多对一查询）"></a>自定义映射（多对一查询）</h3><p>对个员工对应一个部门。</p>
<h4 id="方式1"><a href="#方式1" class="headerlink" title="方式1"></a>方式1</h4><p>在 Emp 实体类中新增 Dept 字段属性，表示员工所属的部门信息。要实现查询所有的员工，并显示所在的部门信息。</p>
<p>我们可以在 mapper.xml 中设置 resultMap 来实现自定义映射。用来处理复杂的表关系。id 标签用于设置主键的映射关系，其中的 column 设置的是字段名，property 设置的是属性名字。非主键需要使用 result 标签。这种方式不常用。</p>
<p>定义 EmpDeptMapper 接口类</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">EmpDeptMapper</span> </span>&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="comment">// 获取所有的员工对象</span></span><br><span class="line">	<span class="function">List&lt;Emp&gt; <span class="title">getAllEmp</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>定义 EmpDeptMapper.xml 映射文件。并在其中定义自定义返回映射 resultMap</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.EmpDeptMapper"</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 自定义映射（一般使用得很少） --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Emp"</span> <span class="attr">id</span>=<span class="string">"empMap"</span>&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 主键使用 id --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"eid"</span> <span class="attr">property</span>=<span class="string">"eid"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- 非主键使用 result --&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ename"</span> <span class="attr">property</span>=<span class="string">"ename"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"dept.did"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dname"</span> <span class="attr">property</span>=<span class="string">"dept.dname"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- List&lt;Emp&gt; getAllEmp(); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllEmp"</span> <span class="attr">resultMap</span>=<span class="string">"empMap"</span>&gt;</span></span><br><span class="line">	select e.eid,e.ename,e.age,e.sex,e.did,d.dname from emp e left join dept d on e.did= d.did</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="方式2"><a href="#方式2" class="headerlink" title="方式2"></a>方式2</h4><p>使用 resultMap 和  association 来完成。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.EmpDeptMapper"</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- 自定义映射（一般使用得很少） --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 	&lt;resultMap type="Emp" id="empMap"&gt;</span></span><br><span class="line"><span class="comment">		主键使用 id</span></span><br><span class="line"><span class="comment">		&lt;id column="eid" property="eid"/&gt;</span></span><br><span class="line"><span class="comment">		非主键使用 result</span></span><br><span class="line"><span class="comment">		&lt;result column="ename" property="ename"/&gt;</span></span><br><span class="line"><span class="comment">		&lt;result column="sex" property="sex"/&gt;</span></span><br><span class="line"><span class="comment">		&lt;result column="did" property="dept.did"/&gt;</span></span><br><span class="line"><span class="comment">		&lt;result column="dname" property="dept.dname"/&gt;</span></span><br><span class="line"><span class="comment">		&lt;result column="age" property="age"/&gt;</span></span><br><span class="line"><span class="comment">	&lt;/resultMap&gt; --&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Emp"</span> <span class="attr">id</span>=<span class="string">"empMap"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"eid"</span> <span class="attr">property</span>=<span class="string">"eid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ename"</span> <span class="attr">property</span>=<span class="string">"ename"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">javaType</span>=<span class="string">"Dept"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dname"</span> <span class="attr">property</span>=<span class="string">"dname"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- List&lt;Emp&gt; getAllEmp(); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllEmp"</span> <span class="attr">resultMap</span>=<span class="string">"empMap"</span>&gt;</span></span><br><span class="line">  select e.eid,e.ename,e.age,e.sex,e.did,d.dname from emp e left join dept d on e.did= d.did</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">	</span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>实体类，接口类和测试类都和方式1一样，只是这里使用 resultMap 和 association 来实现。</p>
<h3 id="association-分步查询-延迟加载"><a href="#association-分步查询-延迟加载" class="headerlink" title="association 分步查询/延迟加载"></a>association 分步查询/延迟加载</h3><h4 id="分步查询"><a href="#分步查询" class="headerlink" title="分步查询"></a>分步查询</h4><p>对于查询员工信息并且将对应的部门信息也查询出来的需求，就可以通过分步的方式完成查询。</p>
<ol>
<li><p>先通过员工的id查询员工信息</p>
</li>
<li><p>再通过查询出来的员工信息中的外键(部门id)查询对应的部门信息. </p>
</li>
</ol>
<p>先通过员工 id 查询员工信息, EmpDeptMapper 接口中的方法为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分步查询。先查询 Emp 信息，然后在通过 Emp 信息查询 Dept 信息。</span></span><br><span class="line"><span class="function">Emp <span class="title">getEmpStep</span><span class="params">(String eid)</span></span>;</span><br></pre></td></tr></table></figure>
<p>EmpDeptMapper 中 xml 的配置如下：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 分步查询。这里表示先通过eid查询员工信息,然后在拿着员工信息中的did去Dept中查询对应的dept信息 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Emp"</span> <span class="attr">id</span>=<span class="string">"empMapStep"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"eid"</span> <span class="attr">property</span>=<span class="string">"eid"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ename"</span> <span class="attr">property</span>=<span class="string">"ename"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			 select 表示分步查询的 SQL，值是接口的全限定名.方法名。 </span></span><br><span class="line"><span class="comment">			 column 表示要将哪个字段的值传入 getDeptByDid 中进行查询 </span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"dept"</span> <span class="attr">select</span>=<span class="string">"com.atguigu.mapper.DeptMapper.getDeptByDid"</span> <span class="attr">column</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpStep"</span> <span class="attr">resultMap</span>=<span class="string">"empMapStep"</span>&gt;</span></span><br><span class="line">		select eid, ename, age, sex, did from emp where eid = #&#123;eid&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>com.atguigu.mapper.DeptMapper 中的 getDeptByDid 接口如下。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Dept;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">DeptMapper</span> </span>&#123;</span><br><span class="line">	<span class="function">Dept <span class="title">getDeptByDid</span><span class="params">(String did)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8" ?&gt;</span> <span class="meta">&lt;!DOCTYPE mapper</span></span><br><span class="line"><span class="meta">PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"</span></span><br><span class="line"><span class="meta">"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.atguigu.mapper.DeptMapper"</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- Dept getDeptByDid(String did); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptByDid"</span> <span class="attr">resultType</span>=<span class="string">"Dept"</span>&gt;</span></span><br><span class="line">		select did, dname from dept where did = #&#123;did&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="延迟加载"><a href="#延迟加载" class="headerlink" title="延迟加载"></a>延迟加载</h4><p>只对分布查询有效果，例如上面的例子中，emp 中包含了 dept 对象，如果只用到了 emp 中的信息那么就先查询 emp 的信息，如果用到了 dept 信息那么才会去查询 dept。</p>
<p>开启延迟加载需要在 mybits 的核心配置文件中进行设置。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 下划线转驼峰 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"mapUnderscoreToCamelCase"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 开启延迟加载 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 设置加载的数据是按需还是全部 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">// 只去查询 emp 信息</span></span><br><span class="line">Emp empStep = empDeptMapper.getEmpStep(<span class="string">"2"</span>);</span><br><span class="line">System.out.println(empStep.getEname());</span><br><span class="line"><span class="comment">// 用到了 dept 才去执行 dept 的查询语句</span></span><br><span class="line">System.out.println(empStep.getDept().getDname());</span><br></pre></td></tr></table></figure>
<h3 id="自定义映射（一对多查询）"><a href="#自定义映射（一对多查询）" class="headerlink" title="自定义映射（一对多查询）"></a>自定义映射（一对多查询）</h3><p>一个部门对应对个员工</p>
<p>在 EmpDeptMapper 接口类中定义 getDeptEmpsByDid 方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取 dept 的信息，包括里面的员工信息</span></span><br><span class="line"><span class="function">Dept <span class="title">getDeptEmpsByDid</span><span class="params">(String did)</span></span>;</span><br></pre></td></tr></table></figure>
<p>定义 mapper.xml 映射文件。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--Dept getDeptEmpsByDid(String did);  --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Dept"</span> <span class="attr">id</span>=<span class="string">"deptMap"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dname"</span> <span class="attr">property</span>=<span class="string">"dname"</span>/&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">			注意这里和多对一不同，这里是一对多，所以这里要用 collection。</span></span><br><span class="line"><span class="comment">			而且这里不用 javaType，而要用 ofType，用来表示 collection 中存的是什么 </span></span><br><span class="line"><span class="comment">		--&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"emps"</span> <span class="attr">ofType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"eid"</span> <span class="attr">property</span>=<span class="string">"eid"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"ename"</span> <span class="attr">property</span>=<span class="string">"ename"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"age"</span> <span class="attr">property</span>=<span class="string">"age"</span>/&gt;</span></span><br><span class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"sex"</span> <span class="attr">property</span>=<span class="string">"sex"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getDeptEmpsByDid"</span> <span class="attr">resultMap</span>=<span class="string">"deptMap"</span>&gt;</span></span><br><span class="line">		select d.did, d.dname, e.eid, e.ename, e.age, e.sex from dept d left join emp e on d.did = e.did where d.did = #&#123;did&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>collection 是用来处理一对多和多对多的关系的，其中的 ofType 指的是集合中数据的类型。collection 中不需要指定 javaType。</p>
<p>测试代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> org.junit.Assert.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.IOException;</span><br><span class="line"><span class="keyword">import</span> java.io.InputStream;</span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.io.Resources;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSession;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactory;</span><br><span class="line"><span class="keyword">import</span> org.apache.ibatis.session.SqlSessionFactoryBuilder;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Dept;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.bean.Emp;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.EmpDeptMapper;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.EmpSelectMapper;</span><br><span class="line"><span class="keyword">import</span> com.atguigu.mapper.ParamMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestEmpDept</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Test</span></span><br><span class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">test</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">		InputStream is = Resources.getResourceAsStream(<span class="string">"mybatis-conf.xml"</span>);</span><br><span class="line">		SqlSessionFactory sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(is);</span><br><span class="line">		SqlSession sqlSession = sqlSessionFactory.openSession(<span class="keyword">true</span>); </span><br><span class="line">		</span><br><span class="line">		EmpDeptMapper empDeptMapper = sqlSession.getMapper(EmpDeptMapper<span class="class">.<span class="keyword">class</span>)</span>;</span><br><span class="line">		<span class="comment">// List&lt;Emp&gt; allEmp = empDeptMapper.getAllEmp();</span></span><br><span class="line">		<span class="comment">// System.out.println(allEmp);</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">// 只去查询 emp 信息</span></span><br><span class="line">		<span class="comment">// Emp empStep = empDeptMapper.getEmpStep("2");</span></span><br><span class="line">		<span class="comment">// System.out.println(empStep.getEname());</span></span><br><span class="line">		<span class="comment">// 用到了 dept 才去执行 dept 的查询语句</span></span><br><span class="line">		<span class="comment">// System.out.println(empStep.getDept().getDname());</span></span><br><span class="line">		</span><br><span class="line">		Dept deptEmpsByDid = empDeptMapper.getDeptEmpsByDid(<span class="string">"3"</span>);</span><br><span class="line">		System.out.println(deptEmpsByDid);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="collection-分步查询-延迟加载"><a href="#collection-分步查询-延迟加载" class="headerlink" title="collection 分步查询/延迟加载"></a>collection 分步查询/延迟加载</h4><h4 id="分步查询-1"><a href="#分步查询-1" class="headerlink" title="分步查询"></a>分步查询</h4><p>对于查询部门信息并且将对应的员工信息也查询出来的需求，就可以通过分步的方式完成查询。</p>
<ol>
<li>先通过部门的id查询部门信息</li>
<li>再通过查询出来的部门信息中的外键(员工id)查询对应的员工信息. </li>
</ol>
<p>先通过部门 id 查询部门信息, EmpDeptMapper 接口中的方法为</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 分步查询。先查询 Dept 信息，然后在通过 Dept 信息查询 Emp 信息。</span></span><br><span class="line"><span class="function">Dept <span class="title">getOnlyDeptByDid</span><span class="params">(String did)</span></span>;</span><br></pre></td></tr></table></figure>
<p>EmpDeptMapper 中 xml 的配置如下：</p>
<p>写法和 association 中的分步查询中类似的，只不过一个是 association 中写 select 和 column，这个是 collection 中写 select 和 column。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Dept getOnlyDeptByDid(String did); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Dept"</span> <span class="attr">id</span>=<span class="string">"deptMapStep"</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dname"</span> <span class="attr">property</span>=<span class="string">"dname"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"emps"</span> <span class="attr">select</span>=<span class="string">"com.atguigu.mapper.EmpMapper.getEmpListByDid"</span> <span class="attr">column</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOnlyDeptByDid"</span> <span class="attr">resultMap</span>=<span class="string">"deptMapStep"</span>&gt;</span></span><br><span class="line">	select did, dname from dept where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在看 com.atguigu.mapper.EmpMapper 抽象类中的 getEmpListByDid 方法的定义</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// 根据部门 id 查询所属该部门的员工</span><br><span class="line">List<span class="tag">&lt;<span class="name">Emp</span>&gt;</span> getEmpListByDid(String did);</span><br></pre></td></tr></table></figure>
<p>对应的 EmpMapper.xml 中的内容为：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- List&lt;Emp&gt; getEmpListByDid(String did); --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getEmpListByDid"</span> <span class="attr">resultType</span>=<span class="string">"Emp"</span>&gt;</span></span><br><span class="line">	select eid, ename, age, sex, did from emp where did = #&#123;did&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>测试代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dept onlyDeptByDid = empDeptMapper.getOnlyDeptByDid(<span class="string">"3"</span>);</span><br><span class="line">System.out.println(onlyDeptByDid.getDname());</span><br></pre></td></tr></table></figure>
<p>这样我们就完成了一对多中的分布查询，通过先查询 dept 中的信息，然后在通过 dept 中的外键 id 信息去到另一个 sql 中查询 emp 信息。</p>
<h4 id="延迟加载-1"><a href="#延迟加载-1" class="headerlink" title="延迟加载"></a>延迟加载</h4><p>因为上面中配置了延迟加载的配置，所以这里的查询也是延迟加载的。但是我们可以单独设置是否需要延迟加载，可以在 collection 标签或者 association 中加上 fetchType 属性。默认 fetchType 的值为 lazy，即允许延迟加载。改为 eager 就不使用延迟加载。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Dept getOnlyDeptByDid(String did); --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Dept"</span> <span class="attr">id</span>=<span class="string">"deptMapStep"</span>&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">property</span>=<span class="string">"did"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">column</span>=<span class="string">"dname"</span> <span class="attr">property</span>=<span class="string">"dname"</span>/&gt;</span></span><br><span class="line">		<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"emps"</span> <span class="attr">select</span>=<span class="string">"com.atguigu.mapper.EmpMapper.getEmpListByDid"</span> <span class="attr">column</span>=<span class="string">"did"</span> <span class="attr">fetchType</span>=<span class="string">"eager"</span>/&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getOnlyDeptByDid"</span> <span class="attr">resultMap</span>=<span class="string">"deptMapStep"</span>&gt;</span></span><br><span class="line">		select did, dname from dept where did = #&#123;did&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><a href="https://github.com/rexyan/it_guigu/tree/master/Spring/Code/Mybatis02" target="_blank" rel="noopener">代码地址</a></p>

    </div>

    
    
    

      <footer class="post-footer">
          
          <div class="post-tags">
              <a href="/tags/Java-大数据/" rel="tag"><i class="fa fa-tag"></i> Java 大数据</a>
              <a href="/tags/Mybatis/" rel="tag"><i class="fa fa-tag"></i> Mybatis</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/03/08/41. Mybatis1 - 入门 demo, 核心配置文件中的属性/" rel="prev" title="41. Mybatis1 - 入门 demo, 核心配置文件中的属性">
      <i class="fa fa-chevron-left"></i> 41. Mybatis1 - 入门 demo, 核心配置文件中的属性
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/03/08/43. Mybatis3 - 动态 SQL, 批量操作, 一级缓存, 二级缓存, 第三方缓存, 逆向工程/" rel="next" title="43. Mybatis3 - 动态 SQL, 批量操作, 一级缓存, 二级缓存, 第三方缓存, 逆向工程">
      43. Mybatis3 - 动态 SQL, 批量操作, 一级缓存, 二级缓存, 第三方缓存, 逆向工程 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#单表增删改查"><span class="nav-number">1.</span> <span class="nav-text">单表增删改查</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#返回值为-Integer-或-bool"><span class="nav-number">2.</span> <span class="nav-text">返回值为 Integer 或 bool</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#package-的方式引入映射文件"><span class="nav-number">3.</span> <span class="nav-text">package 的方式引入映射文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#查询的三种方式"><span class="nav-number">4.</span> <span class="nav-text">查询的三种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简单查询返回实体对象"><span class="nav-number">4.1.</span> <span class="nav-text">简单查询返回实体对象</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查询总记录数量"><span class="nav-number">4.2.</span> <span class="nav-text">查询总记录数量</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#将结果存放在-map-中"><span class="nav-number">4.3.</span> <span class="nav-text">将结果存放在 map 中</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#parameterType"><span class="nav-number">5.</span> <span class="nav-text">parameterType</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取参数值的两种方式"><span class="nav-number">6.</span> <span class="nav-text">获取参数值的两种方式</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#null"><span class="nav-number">6.1.</span> <span class="nav-text">${}</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#-1"><span class="nav-number">6.2.</span> <span class="nav-text">#{}</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取新增自增-ID"><span class="nav-number">7.</span> <span class="nav-text">获取新增自增 ID</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#不同的参数类型取值的方式"><span class="nav-number">8.</span> <span class="nav-text">不同的参数类型取值的方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义映射（多对一查询）"><span class="nav-number">9.</span> <span class="nav-text">自定义映射（多对一查询）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#方式1"><span class="nav-number">9.1.</span> <span class="nav-text">方式1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#方式2"><span class="nav-number">9.2.</span> <span class="nav-text">方式2</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#association-分步查询-延迟加载"><span class="nav-number">10.</span> <span class="nav-text">association 分步查询/延迟加载</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#分步查询"><span class="nav-number">10.1.</span> <span class="nav-text">分步查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#延迟加载"><span class="nav-number">10.2.</span> <span class="nav-text">延迟加载</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义映射（一对多查询）"><span class="nav-number">11.</span> <span class="nav-text">自定义映射（一对多查询）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#collection-分步查询-延迟加载"><span class="nav-number">11.1.</span> <span class="nav-text">collection 分步查询/延迟加载</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#分步查询-1"><span class="nav-number">11.2.</span> <span class="nav-text">分步查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#延迟加载-1"><span class="nav-number">11.3.</span> <span class="nav-text">延迟加载</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Rex"
      src="https://raw.githubusercontent.com/rexyan/warehouse/master/20230809141242.jpg">
  <p class="site-author-name" itemprop="name">Rex</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">446</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">20</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">183</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 2017 – 
  <span itemprop="copyrightYear">2025</span>
  <span class="with-love">
    <i class="fa-hand-o-right"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Rex</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
<script src="/js/utils.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

</body>
</html>
